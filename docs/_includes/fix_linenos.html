{%- comment -%}
Este archivo se utilizaba anteriormente para "arreglar" el HTML producido por Jekyll para
código resaltado con números de línea. Si bien a menudo resuelve problemas de diseño
por la falta de etiquetas HTML, aún genera HTML inválido (al colocar
un elemento `<table>` dentro de un bloque `<code>`). Por lo tanto, ya no
se recomienda usar este workaround. Para más información, consulta la
página de documentación "Fragmentos de código con números de línea":
https://just-the-docs.com/docs/ui-components/code/line-numbers/
(o, docs/ui-components/line-nos.md/)

La siguiente parte de este archivo, incluidos los comentarios y el workaround,
se conserva por compatibilidad hacia atrás.

AGRADECIMIENTOS

La implementación se derivó del workaround proporcionado por
Dmitry Hrabrov (DeXP) en
https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901

EXPLICACIÓN (ANTIGUA)

El HTML producido por el resaltado de Rouge con números de línea es de la forma
`code table`. Jekyll siempre envuelve el HTML resaltado
con `pre`. Este envoltorio no solo es innecesario, sino que también transforma
el HTML conforme producido por Rouge en HTML no conforme, lo que
resulta en reportes de error de validación HTML.

La solución elimina las etiquetas `pre` externas siempre que contengan el patrón
`<table class="rouge-table">`.

Además de evitar errores de validación HTML, la solución permite el uso del
[Jekyll layout para comprimir HTML](http://jch.penibelst.de),
que depende de que las etiquetas `pre` no estén anidadas, según
https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-172069842

USO

(Se pueden usar cualquier nombre para `some_var` y `some_language`.)

{% capture some_var %}
{% highlight some_language linenos %}
Algún código
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=some_var %}

Para fences de código:

{% capture some_var %}
```some_language
Algún código
```
{% endcapture %}
{% assign some_var = some_var | markdownify %}
{% include fix_linenos.html code=some_var %}

ADVERTENCIAS

Lo anterior no funciona cuando `Algún código` contiene la cadena coincidente
`<table class="rouge-table">`.

El uso de este archivo sobrescribe la variable `fix_linenos_code` con `nil`.

{%- endcomment -%}

{% assign fix_linenos_code = include.code %}
{% if fix_linenos_code contains '<table class="rouge-table">' %}
  {% assign fix_linenos_code = fix_linenos_code | replace: '<pre class="highlight">', '<pre>' %}
  {% assign fix_linenos_code = fix_linenos_code | replace: "<pre><code", "<code" %}
  {% assign fix_linenos_code = fix_linenos_code | replace: "</code></pre>", "</code>" %}
{% endif %}
{{ fix_linenos_code }}
{% assign fix_linenos_code = nil %}
